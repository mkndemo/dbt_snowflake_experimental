{{ config(
    materialized='incremental',
    unique_key='PK',
    incremental_strategy='merge',
    on_schema_change='sync_all_columns'
) }}

SELECT
    PK,
    COLUMN_1,
    COLUMN_2,
    COLUMN_3,
    COLUMN_4,
    COLUMN_5,
    COLUMN_6,
    COLUMN_7,
    COLUMN_8,
    COLUMN_9,
    COLUMN_10,
    COLUMN_11,
    COLUMN_12,
    COLUMN_13,
    COLUMN_14,
    COLUMN_15,
    COLUMN_16,
    COLUMN_17,
    COLUMN_18,
    COLUMN_19,
    COLUMN_20,
    COLUMN_21,
    COLUMN_22,
    COLUMN_23,
    COLUMN_24,
    COLUMN_25,
    COLUMN_26,
    COLUMN_27,
    COLUMN_28,
    COLUMN_29,
    COLUMN_30,
    COLUMN_31,
    COLUMN_32,
    COLUMN_33,
    COLUMN_34,
    COLUMN_35,
    COLUMN_36,
    COLUMN_37,
    COLUMN_38,
    COLUMN_39,
    COLUMN_40,
    COLUMN_41,
    COLUMN_42,
    COLUMN_43,
    COLUMN_44,
    COLUMN_45,
    COLUMN_46,
    COLUMN_47,
    COLUMN_48,
    COLUMN_49,
    COLUMN_50,
    COLUMN_51,
    COLUMN_52,
    COLUMN_53,
    COLUMN_54,
    COLUMN_55,
    COLUMN_56,
    COLUMN_57,
    COLUMN_58,
    COLUMN_59,
    COLUMN_60,
    COLUMN_61,
    COLUMN_62,
    COLUMN_63,
    COLUMN_64,
    COLUMN_65,
    COLUMN_66,
    COLUMN_67,
    COLUMN_68,
    COLUMN_69,
    COLUMN_70,
    COLUMN_71,
    COLUMN_72,
    COLUMN_73,
    COLUMN_74,
    COLUMN_75,
    COLUMN_76,
    COLUMN_77,
    COLUMN_78,
    COLUMN_79,
    COLUMN_80,
    COLUMN_81,
    COLUMN_82,
    COLUMN_83,
    COLUMN_84,
    COLUMN_85,
    COLUMN_86,
    COLUMN_87,
    COLUMN_88,
    COLUMN_89,
    COLUMN_90,
    COLUMN_91,
    COLUMN_92,
    COLUMN_93,
    COLUMN_94,
    COLUMN_95,
    COLUMN_96,
    COLUMN_97,
    COLUMN_98,
    COLUMN_99,
    COLUMN_100,
    COLUMN_101,
    COLUMN_102,
    COLUMN_103,
    COLUMN_104,
    COLUMN_105,
    COLUMN_106,
    COLUMN_107,
    COLUMN_108,
    COLUMN_109,
    COLUMN_110,
    COLUMN_111,
    COLUMN_112,
    COLUMN_113,
    COLUMN_114,
    COLUMN_115,
    COLUMN_116,
    COLUMN_117,
    COLUMN_118,
    COLUMN_119,
    COLUMN_120,
    COLUMN_121,
    COLUMN_122,
    COLUMN_123,
    COLUMN_124,
    COLUMN_125,
    COLUMN_126,
    COLUMN_127,
    COLUMN_128,
    COLUMN_129,
    COLUMN_130,
    COLUMN_131,
    COLUMN_132,
    COLUMN_133,
    COLUMN_134,
    COLUMN_135,
    COLUMN_136,
    COLUMN_137,
    COLUMN_138,
    COLUMN_139,
    COLUMN_140,
    COLUMN_141,
    COLUMN_142,
    COLUMN_143,
    COLUMN_144,
    COLUMN_145,
    COLUMN_146,
    COLUMN_147,
    COLUMN_148,
    COLUMN_149,
    COLUMN_150,
    COLUMN_151,
    COLUMN_152,
    COLUMN_153,
    COLUMN_154,
    COLUMN_155,
    COLUMN_156,
    COLUMN_157,
    COLUMN_158,
    COLUMN_159,
    COLUMN_160,
    COLUMN_161,
    COLUMN_162,
    COLUMN_163,
    COLUMN_164,
    COLUMN_165,
    COLUMN_166,
    COLUMN_167,
    COLUMN_168,
    COLUMN_169,
    COLUMN_170,
    COLUMN_171,
    COLUMN_172,
    COLUMN_173,
    COLUMN_174,
    COLUMN_175,
    COLUMN_176,
    COLUMN_177,
    COLUMN_178,
    COLUMN_179,
    COLUMN_180,
    COLUMN_181,
    COLUMN_182,
    COLUMN_183,
    COLUMN_184,
    COLUMN_185,
    COLUMN_186,
    COLUMN_187,
    COLUMN_188,
    COLUMN_189,
    COLUMN_190,
    COLUMN_191,
    COLUMN_192,
    COLUMN_193,
    COLUMN_194,
    COLUMN_195,
    COLUMN_196,
    COLUMN_197,
    COLUMN_198,
    COLUMN_199,
    COLUMN_200,
    UPDATED_AT,
     '{{ invocation_id }}' as batch_id
    
    FROM {{ ref('stg_source_tables__source1') }}

{% if is_incremental() %}
    WHERE UPDATED_AT > (SELECT MAX(UPDATED_AT) FROM {{ this }})
{% endif %}