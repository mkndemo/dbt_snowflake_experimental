-- models/final_table.sql

with source4 as (
    select
        PK,
        Column_5 as Column_5_update,
        Column_200 as Column_200_update
    from {{ ref('stg_source_tables__source4') }}
)

select
    s3.PK,
    s3.Column_1,
    s3.Column_2,
    s3.Column_3,
    s3.Column_4,
    coalesce(source4.Column_5_update, s3.Column_5) as Column_5,
    s3.Column_6,
    s3.Column_7,
    s3.Column_8,
    s3.Column_9,
    s3.Column_10,
    s3.Column_11,
    s3.Column_12,
    s3.Column_13,
    s3.Column_14,
    s3.Column_15,
    s3.Column_16,
    s3.Column_17,
    s3.Column_18,
    s3.Column_19,
    s3.Column_20,
    s3.Column_21,
    s3.Column_22,
    s3.Column_23,
    s3.Column_24,
    s3.Column_25,
    s3.Column_26,
    s3.Column_27,
    s3.Column_28,
    s3.Column_29,
    s3.Column_30,
    s3.Column_31,
    s3.Column_32,
    s3.Column_33,
    s3.Column_34,
    s3.Column_35,
    s3.Column_36,
    s3.Column_37,
    s3.Column_38,
    s3.Column_39,
    s3.Column_40,
    s3.Column_41,
    s3.Column_42,
    s3.Column_43,
    s3.Column_44,
    s3.Column_45,
    s3.Column_46,
    s3.Column_47,
    s3.Column_48,
    s3.Column_49,
    s3.Column_50,
    s3.Column_51,
    s3.Column_52,
    s3.Column_53,
    s3.Column_54,
    s3.Column_55,
    s3.Column_56,
    s3.Column_57,
    s3.Column_58,
    s3.Column_59,
    s3.Column_60,
    s3.Column_61,
    s3.Column_62,
    s3.Column_63,
    s3.Column_64,
    s3.Column_65,
    s3.Column_66,
    s3.Column_67,
    s3.Column_68,
    s3.Column_69,
    s3.Column_70,
    s3.Column_71,
    s3.Column_72,
    s3.Column_73,
    s3.Column_74,
    s3.Column_75,
    s3.Column_76,
    s3.Column_77,
    s3.Column_78,
    s3.Column_79,
    s3.Column_80,
    s3.Column_81,
    s3.Column_82,
    s3.Column_83,
    s3.Column_84,
    s3.Column_85,
    s3.Column_86,
    s3.Column_87,
    s3.Column_88,
    s3.Column_89,
    s3.Column_90,
    s3.Column_91,
    s3.Column_92,
    s3.Column_93,
    s3.Column_94,
    s3.Column_95,
    s3.Column_96,
    s3.Column_97,
    s3.Column_98,
    s3.Column_99,
    s3.Column_100,
    s3.Column_101,
    s3.Column_102,
    s3.Column_103,
    s3.Column_104,
    s3.Column_105,
    s3.Column_106,
    s3.Column_107,
    s3.Column_108,
    s3.Column_109,
    s3.Column_110,
    s3.Column_111,
    s3.Column_112,
    s3.Column_113,
    s3.Column_114,
    s3.Column_115,
    s3.Column_116,
    s3.Column_117,
    s3.Column_118,
    s3.Column_119,
    s3.Column_120,
    s3.Column_121,
    s3.Column_122,
    s3.Column_123,
    s3.Column_124,
    s3.Column_125,
    s3.Column_126,
    s3.Column_127,
    s3.Column_128,
    s3.Column_129,
    s3.Column_130,
    s3.Column_131,
    s3.Column_132,
    s3.Column_133,
    s3.Column_134,
    s3.Column_135,
    s3.Column_136,
    s3.Column_137,
    s3.Column_138,
    s3.Column_139,
    s3.Column_140,
    s3.Column_141,
    s3.Column_142,
    s3.Column_143,
    s3.Column_144,
    s3.Column_145,
    s3.Column_146,
    s3.Column_147,
    s3.Column_148,
    s3.Column_149,
    s3.Column_150,
    s3.Column_151,
    s3.Column_152,
    s3.Column_153,
    s3.Column_154,
    s3.Column_155,
    s3.Column_156,
    s3.Column_157,
    s3.Column_158,
    s3.Column_159,
    s3.Column_160,
    s3.Column_161,
    s3.Column_162,
    s3.Column_163,
    s3.Column_164,
    s3.Column_165,
    s3.Column_166,
    s3.Column_167,
    s3.Column_168,
    s3.Column_169,
    s3.Column_170,
    s3.Column_171,
    s3.Column_172,
    s3.Column_173,
    s3.Column_174,
    s3.Column_175,
    s3.Column_176,
    s3.Column_177,
    s3.Column_178,
    s3.Column_179,
    s3.Column_180,
    s3.Column_181,
    s3.Column_182,
    s3.Column_183,
    s3.Column_184,
    s3.Column_185,
    s3.Column_186,
    s3.Column_187,
    s3.Column_188,
    s3.Column_189,
    s3.Column_190,
    s3.Column_191,
    s3.Column_192,
    s3.Column_193,
    s3.Column_194,
    s3.Column_195,
    s3.Column_196,
    s3.Column_197,
    s3.Column_198,
    s3.Column_199,
    coalesce(source4.Column_200_update, s3.Column_200) as Column_200,
    updated_at
from {{ ref('inter_customers_step3') }} as s3
left join source4 on s3.PK = source4.PK
