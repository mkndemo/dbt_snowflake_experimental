-- models/step3.sql
{{ config( materialized='view') }}

with source3 as (
    select
        PK,
        Column_2 as Column_2_update,
        Column_4 as Column_4_update
    from {{ ref('stg_source_tables__source3') }}
)

select
    s2.PK,
    s2.Column_1,
    coalesce(source3.Column_2_update, s2.Column_2) as Column_2,
    s2.Column_3,
    coalesce(source3.Column_4_update, s2.Column_4) as Column_4,
    s2.Column_5,
    s2.Column_6,
    s2.Column_7,
    s2.Column_8,
    s2.Column_9,
    s2.Column_10,
    s2.Column_11,
    s2.Column_12,
    s2.Column_13,
    s2.Column_14,
    s2.Column_15,
    s2.Column_16,
    s2.Column_17,
    s2.Column_18,
    s2.Column_19,
    s2.Column_20,
    s2.Column_21,
    s2.Column_22,
    s2.Column_23,
    s2.Column_24,
    s2.Column_25,
    s2.Column_26,
    s2.Column_27,
    s2.Column_28,
    s2.Column_29,
    s2.Column_30,
    s2.Column_31,
    s2.Column_32,
    s2.Column_33,
    s2.Column_34,
    s2.Column_35,
    s2.Column_36,
    s2.Column_37,
    s2.Column_38,
    s2.Column_39,
    s2.Column_40,
    s2.Column_41,
    s2.Column_42,
    s2.Column_43,
    s2.Column_44,
    s2.Column_45,
    s2.Column_46,
    s2.Column_47,
    s2.Column_48,
    s2.Column_49,
    s2.Column_50,
    s2.Column_51,
    s2.Column_52,
    s2.Column_53,
    s2.Column_54,
    s2.Column_55,
    s2.Column_56,
    s2.Column_57,
    s2.Column_58,
    s2.Column_59,
    s2.Column_60,
    s2.Column_61,
    s2.Column_62,
    s2.Column_63,
    s2.Column_64,
    s2.Column_65,
    s2.Column_66,
    s2.Column_67,
    s2.Column_68,
    s2.Column_69,
    s2.Column_70,
    s2.Column_71,
    s2.Column_72,
    s2.Column_73,
    s2.Column_74,
    s2.Column_75,
    s2.Column_76,
    s2.Column_77,
    s2.Column_78,
    s2.Column_79,
    s2.Column_80,
    s2.Column_81,
    s2.Column_82,
    s2.Column_83,
    s2.Column_84,
    s2.Column_85,
    s2.Column_86,
    s2.Column_87,
    s2.Column_88,
    s2.Column_89,
    s2.Column_90,
    s2.Column_91,
    s2.Column_92,
    s2.Column_93,
    s2.Column_94,
    s2.Column_95,
    s2.Column_96,
    s2.Column_97,
    s2.Column_98,
    s2.Column_99,
    s2.Column_100,
    s2.Column_101,
    s2.Column_102,
    s2.Column_103,
    s2.Column_104,
    s2.Column_105,
    s2.Column_106,
    s2.Column_107,
    s2.Column_108,
    s2.Column_109,
    s2.Column_110,
    s2.Column_111,
    s2.Column_112,
    s2.Column_113,
    s2.Column_114,
    s2.Column_115,
    s2.Column_116,
    s2.Column_117,
    s2.Column_118,
    s2.Column_119,
    s2.Column_120,
    s2.Column_121,
    s2.Column_122,
    s2.Column_123,
    s2.Column_124,
    s2.Column_125,
    s2.Column_126,
    s2.Column_127,
    s2.Column_128,
    s2.Column_129,
    s2.Column_130,
    s2.Column_131,
    s2.Column_132,
    s2.Column_133,
    s2.Column_134,
    s2.Column_135,
    s2.Column_136,
    s2.Column_137,
    s2.Column_138,
    s2.Column_139,
    s2.Column_140,
    s2.Column_141,
    s2.Column_142,
    s2.Column_143,
    s2.Column_144,
    s2.Column_145,
    s2.Column_146,
    s2.Column_147,
    s2.Column_148,
    s2.Column_149,
    s2.Column_150,
    s2.Column_151,
    s2.Column_152,
    s2.Column_153,
    s2.Column_154,
    s2.Column_155,
    s2.Column_156,
    s2.Column_157,
    s2.Column_158,
    s2.Column_159,
    s2.Column_160,
    s2.Column_161,
    s2.Column_162,
    s2.Column_163,
    s2.Column_164,
    s2.Column_165,
    s2.Column_166,
    s2.Column_167,
    s2.Column_168,
    s2.Column_169,
    s2.Column_170,
    s2.Column_171,
    s2.Column_172,
    s2.Column_173,
    s2.Column_174,
    s2.Column_175,
    s2.Column_176,
    s2.Column_177,
    s2.Column_178,
    s2.Column_179,
    s2.Column_180,
    s2.Column_181,
    s2.Column_182,
    s2.Column_183,
    s2.Column_184,
    s2.Column_185,
    s2.Column_186,
    s2.Column_187,
    s2.Column_188,
    s2.Column_189,
    s2.Column_190,
    s2.Column_191,
    s2.Column_192,
    s2.Column_193,
    s2.Column_194,
    s2.Column_195,
    s2.Column_196,
    s2.Column_197,
    s2.Column_198,
    s2.Column_199,
    s2.Column_200,
    s2.updated_at
from {{ ref('inter_customers_step2') }} as s2
left join source3 on s2.PK = source3.PK
