with source1 as (

    select
        PK,
        Column_1,
        Column_2,
        Column_3,
        Column_4,
        Column_5,
        Column_6,
        Column_7,
        Column_8,
        Column_9,
        Column_10,
        Column_11,
        Column_12,
        Column_13,
        Column_14,
        Column_15,
        Column_16,
        Column_17,
        Column_18,
        Column_19,
        Column_20,
        Column_21,
        Column_22,
        Column_23,
        Column_24,
        Column_25,
        Column_26,
        Column_27,
        Column_28,
        Column_29,
        Column_30,
        Column_31,
        Column_32,
        Column_33,
        Column_34,
        Column_35,
        Column_36,
        Column_37,
        Column_38,
        Column_39,
        Column_40,
        Column_41,
        Column_42,
        Column_43,
        Column_44,
        Column_45,
        Column_46,
        Column_47,
        Column_48,
        Column_49,
        Column_50,
        Column_51,
        Column_52,
        Column_53,
        Column_54,
        Column_55,
        Column_56,
        Column_57,
        Column_58,
        Column_59,
        Column_60,
        Column_61,
        Column_62,
        Column_63,
        Column_64,
        Column_65,
        Column_66,
        Column_67,
        Column_68,
        Column_69,
        Column_70,
        Column_71,
        Column_72,
        Column_73,
        Column_74,
        Column_75,
        Column_76,
        Column_77,
        Column_78,
        Column_79,
        Column_80,
        Column_81,
        Column_82,
        Column_83,
        Column_84,
        Column_85,
        Column_86,
        Column_87,
        Column_88,
        Column_89,
        Column_90,
        Column_91,
        Column_92,
        Column_93,
        Column_94,
        Column_95,
        Column_96,
        Column_97,
        Column_98,
        Column_99,
        Column_100,
        Column_101,
        Column_102,
        Column_103,
        Column_104,
        Column_105,
        Column_106,
        Column_107,
        Column_108,
        Column_109,
        Column_110,
        Column_111,
        Column_112,
        Column_113,
        Column_114,
        Column_115,
        Column_116,
        Column_117,
        Column_118,
        Column_119,
        Column_120,
        Column_121,
        Column_122,
        Column_123,
        Column_124,
        Column_125,
        Column_126,
        Column_127,
        Column_128,
        Column_129,
        Column_130,
        Column_131,
        Column_132,
        Column_133,
        Column_134,
        Column_135,
        Column_136,
        Column_137,
        Column_138,
        Column_139,
        Column_140,
        Column_141,
        Column_142,
        Column_143,
        Column_144,
        Column_145,
        Column_146,
        Column_147,
        Column_148,
        Column_149,
        Column_150,
        Column_151,
        Column_152,
        Column_153,
        Column_154,
        Column_155,
        Column_156,
        Column_157,
        Column_158,
        Column_159,
        Column_160,
        Column_161,
        Column_162,
        Column_163,
        Column_164,
        Column_165,
        Column_166,
        Column_167,
        Column_168,
        Column_169,
        Column_170,
        Column_171,
        Column_172,
        Column_173,
        Column_174,
        Column_175,
        Column_176,
        Column_177,
        Column_178,
        Column_179,
        Column_180,
        Column_181,
        Column_182,
        Column_183,
        Column_184,
        Column_185,
        Column_186,
        Column_187,
        Column_188,
        Column_189,
        Column_190,
        Column_191,
        Column_192,
        Column_193,
        Column_194,
        Column_195,
        Column_196,
        Column_197,
        Column_198,
        Column_199,
        Column_200,
        updated_at
    from {{ ref('stg_source_tables__source1') }}

),

source2 as (

    select
        PK,
        Column_3 as Column_3_update
    from {{ ref('stg_source_tables__source2') }}

),

source3 as (

    select
        PK,
        Column_2 as Column_2_update,
        Column_4 as Column_4_update
    from {{ ref('stg_source_tables__source3') }}

),

source4 as (

    select
        PK,
        Column_5 as Column_5_update,
        column_200 as Column_200_update
    from {{ ref('stg_source_tables__source4') }}

),

step1 as (

    -- Start with Source 1 data
    select * from source1

),

step2 as (

    -- Update Column_3 from Source 2
    select
        s1.pk,
        s1.column_1,
        s1.column_2,
        coalesce(source2.column_3_update, s1.column_3) as column_3,
        s1.column_4,
        s1.column_5,
        s1.column_6,
        s1.column_7,
        s1.column_8,
        s1.column_9,
        s1.column_10,
        s1.column_11,
        s1.column_12,
        s1.column_13,
        s1.column_14,
        s1.column_15,
        s1.column_16,
        s1.column_17,
        s1.column_18,
        s1.column_19,
        s1.column_20,
        s1.column_21,
        s1.column_22,
        s1.column_23,
        s1.column_24,
        s1.column_25,
        s1.column_26,
        s1.column_27,
        s1.column_28,
        s1.column_29,
        s1.column_30,
        s1.column_31,
        s1.column_32,
        s1.column_33,
        s1.column_34,
        s1.column_35,
        s1.column_36,
        s1.column_37,
        s1.column_38,
        s1.column_39,
        s1.column_40,
        s1.column_41,
        s1.column_42,
        s1.column_43,
        s1.column_44,
        s1.column_45,
        s1.column_46,
        s1.column_47,
        s1.column_48,
        s1.column_49,
        s1.column_50,
        s1.column_51,
        s1.column_52,
        s1.column_53,
        s1.column_54,
        s1.column_55,
        s1.column_56,
        s1.column_57,
        s1.column_58,
        s1.column_59,
        s1.column_60,
        s1.column_61,
        s1.column_62,
        s1.column_63,
        s1.column_64,
        s1.column_65,
        s1.column_66,
        s1.column_67,
        s1.column_68,
        s1.column_69,
        s1.column_70,
        s1.column_71,
        s1.column_72,
        s1.column_73,
        s1.column_74,
        s1.column_75,
        s1.column_76,
        s1.column_77,
        s1.column_78,
        s1.column_79,
        s1.column_80,
        s1.column_81,
        s1.column_82,
        s1.column_83,
        s1.column_84,
        s1.column_85,
        s1.column_86,
        s1.column_87,
        s1.column_88,
        s1.column_89,
        s1.column_90,
        s1.column_91,
        s1.column_92,
        s1.column_93,
        s1.column_94,
        s1.column_95,
        s1.column_96,
        s1.column_97,
        s1.column_98,
        s1.column_99,
        s1.column_100,
        s1.column_101,
        s1.column_102,
        s1.column_103,
        s1.column_104,
        s1.column_105,
        s1.column_106,
        s1.column_107,
        s1.column_108,
        s1.column_109,
        s1.column_110,
        s1.column_111,
        s1.column_112,
        s1.column_113,
        s1.column_114,
        s1.column_115,
        s1.column_116,
        s1.column_117,
        s1.column_118,
        s1.column_119,
        s1.column_120,
        s1.column_121,
        s1.column_122,
        s1.column_123,
        s1.column_124,
        s1.column_125,
        s1.column_126,
        s1.column_127,
        s1.column_128,
        s1.column_129,
        s1.column_130,
        s1.column_131,
        s1.column_132,
        s1.column_133,
        s1.column_134,
        s1.column_135,
        s1.column_136,
        s1.column_137,
        s1.column_138,
        s1.column_139,
        s1.column_140,
        s1.column_141,
        s1.column_142,
        s1.column_143,
        s1.column_144,
        s1.column_145,
        s1.column_146,
        s1.column_147,
        s1.column_148,
        s1.column_149,
        s1.column_150,
        s1.column_151,
        s1.column_152,
        s1.column_153,
        s1.column_154,
        s1.column_155,
        s1.column_156,
        s1.column_157,
        s1.column_158,
        s1.column_159,
        s1.column_160,
        s1.column_161,
        s1.column_162,
        s1.column_163,
        s1.column_164,
        s1.column_165,
        s1.column_166,
        s1.column_167,
        s1.column_168,
        s1.column_169,
        s1.column_170,
        s1.column_171,
        s1.column_172,
        s1.column_173,
        s1.column_174,
        s1.column_175,
        s1.column_176,
        s1.column_177,
        s1.column_178,
        s1.column_179,
        s1.column_180,
        s1.column_181,
        s1.column_182,
        s1.column_183,
        s1.column_184,
        s1.column_185,
        s1.column_186,
        s1.column_187,
        s1.column_188,
        s1.column_189,
        s1.column_190,
        s1.column_191,
        s1.column_192,
        s1.column_193,
        s1.column_194,
        s1.column_195,
        s1.column_196,
        s1.column_197,
        s1.column_198,
        s1.column_199,
        s1.column_200,
        updated_at
    from step1 as s1
    left join source2 on s1.pk = source2.pk

),

step3 as (

    -- Update Column_2 and Column_4 from Source 3
    select
        s2.PK,
        s2.Column_1,
        coalesce(source3.Column_2_update, s2.Column_2) as Column_2,
        s2.Column_3,
        coalesce(source3.Column_4_update, s2.Column_4) as Column_4,
        s2.Column_5,
        s2.Column_6,
        s2.Column_7,
        s2.Column_8,
        s2.Column_9,
        s2.Column_10,
        s2.Column_11,
        s2.Column_12,
        s2.Column_13,
        s2.Column_14,
        s2.Column_15,
        s2.Column_16,
        s2.Column_17,
        s2.Column_18,
        s2.Column_19,
        s2.Column_20,
        s2.Column_21,
        s2.Column_22,
        s2.Column_23,
        s2.Column_24,
        s2.Column_25,
        s2.Column_26,
        s2.Column_27,
        s2.Column_28,
        s2.Column_29,
        s2.Column_30,
        s2.Column_31,
        s2.Column_32,
        s2.Column_33,
        s2.Column_34,
        s2.Column_35,
        s2.Column_36,
        s2.Column_37,
        s2.Column_38,
        s2.Column_39,
        s2.Column_40,
        s2.Column_41,
        s2.Column_42,
        s2.Column_43,
        s2.Column_44,
        s2.Column_45,
        s2.Column_46,
        s2.Column_47,
        s2.Column_48,
        s2.Column_49,
        s2.Column_50,
        s2.Column_51,
        s2.Column_52,
        s2.Column_53,
        s2.Column_54,
        s2.Column_55,
        s2.Column_56,
        s2.Column_57,
        s2.Column_58,
        s2.Column_59,
        s2.Column_60,
        s2.Column_61,
        s2.Column_62,
        s2.Column_63,
        s2.Column_64,
        s2.Column_65,
        s2.Column_66,
        s2.Column_67,
        s2.Column_68,
        s2.Column_69,
        s2.Column_70,
        s2.Column_71,
        s2.Column_72,
        s2.Column_73,
        s2.Column_74,
        s2.Column_75,
        s2.Column_76,
        s2.Column_77,
        s2.Column_78,
        s2.Column_79,
        s2.Column_80,
        s2.Column_81,
        s2.Column_82,
        s2.Column_83,
        s2.Column_84,
        s2.Column_85,
        s2.Column_86,
        s2.Column_87,
        s2.Column_88,
        s2.Column_89,
        s2.Column_90,
        s2.Column_91,
        s2.Column_92,
        s2.Column_93,
        s2.Column_94,
        s2.Column_95,
        s2.Column_96,
        s2.Column_97,
        s2.Column_98,
        s2.Column_99,
        s2.Column_100,
        s2.Column_101,
        s2.Column_102,
        s2.Column_103,
        s2.Column_104,
        s2.Column_105,
        s2.Column_106,
        s2.Column_107,
        s2.Column_108,
        s2.Column_109,
        s2.Column_110,
        s2.Column_111,
        s2.Column_112,
        s2.Column_113,
        s2.Column_114,
        s2.Column_115,
        s2.Column_116,
        s2.Column_117,
        s2.Column_118,
        s2.Column_119,
        s2.Column_120,
        s2.Column_121,
        s2.Column_122,
        s2.Column_123,
        s2.Column_124,
        s2.Column_125,
        s2.Column_126,
        s2.Column_127,
        s2.Column_128,
        s2.Column_129,
        s2.Column_130,
        s2.Column_131,
        s2.Column_132,
        s2.Column_133,
        s2.Column_134,
        s2.Column_135,
        s2.Column_136,
        s2.Column_137,
        s2.Column_138,
        s2.Column_139,
        s2.Column_140,
        s2.Column_141,
        s2.Column_142,
        s2.Column_143,
        s2.Column_144,
        s2.Column_145,
        s2.Column_146,
        s2.Column_147,
        s2.Column_148,
        s2.Column_149,
        s2.Column_150,
        s2.Column_151,
        s2.Column_152,
        s2.Column_153,
        s2.Column_154,
        s2.Column_155,
        s2.Column_156,
        s2.Column_157,
        s2.Column_158,
        s2.Column_159,
        s2.Column_160,
        s2.Column_161,
        s2.Column_162,
        s2.Column_163,
        s2.Column_164,
        s2.Column_165,
        s2.Column_166,
        s2.Column_167,
        s2.Column_168,
        s2.Column_169,
        s2.Column_170,
        s2.Column_171,
        s2.Column_172,
        s2.Column_173,
        s2.Column_174,
        s2.Column_175,
        s2.Column_176,
        s2.Column_177,
        s2.Column_178,
        s2.Column_179,
        s2.Column_180,
        s2.Column_181,
        s2.Column_182,
        s2.Column_183,
        s2.Column_184,
        s2.Column_185,
        s2.Column_186,
        s2.Column_187,
        s2.Column_188,
        s2.Column_189,
        s2.Column_190,
        s2.Column_191,
        s2.Column_192,
        s2.Column_193,
        s2.Column_194,
        s2.Column_195,
        s2.Column_196,
        s2.Column_197,
        s2.Column_198,
        s2.Column_199,
        s2.Column_200,
        updated_at
    from step2 as s2
    left join source3 on s2.PK = source3.PK

),

step4 as (

    -- Update Column_5 and Column_200 from Source 4
    select
        s3.PK,
        s3.Column_1,
        s3.Column_2,
        s3.Column_3,
        s3.Column_4,
        coalesce(source4.Column_5_update, s3.Column_5) as Column_5,
        s3.Column_6,
        s3.Column_7,
        s3.Column_8,
        s3.Column_9,
        s3.Column_10,
        s3.Column_11,
        s3.Column_12,
        s3.Column_13,
        s3.Column_14,
        s3.Column_15,
        s3.Column_16,
        s3.Column_17,
        s3.Column_18,
        s3.Column_19,
        s3.Column_20,
        s3.Column_21,
        s3.Column_22,
        s3.Column_23,
        s3.Column_24,
        s3.Column_25,
        s3.Column_26,
        s3.Column_27,
        s3.Column_28,
        s3.Column_29,
        s3.Column_30,
        s3.Column_31,
        s3.Column_32,
        s3.Column_33,
        s3.Column_34,
        s3.Column_35,
        s3.Column_36,
        s3.Column_37,
        s3.Column_38,
        s3.Column_39,
        s3.Column_40,
        s3.Column_41,
        s3.Column_42,
        s3.Column_43,
        s3.Column_44,
        s3.Column_45,
        s3.Column_46,
        s3.Column_47,
        s3.Column_48,
        s3.Column_49,
        s3.Column_50,
        s3.Column_51,
        s3.Column_52,
        s3.Column_53,
        s3.Column_54,
        s3.Column_55,
        s3.Column_56,
        s3.Column_57,
        s3.Column_58,
        s3.Column_59,
        s3.Column_60,
        s3.Column_61,
        s3.Column_62,
        s3.Column_63,
        s3.Column_64,
        s3.Column_65,
        s3.Column_66,
        s3.Column_67,
        s3.Column_68,
        s3.Column_69,
        s3.Column_70,
        s3.Column_71,
        s3.Column_72,
        s3.Column_73,
        s3.Column_74,
        s3.Column_75,
        s3.Column_76,
        s3.Column_77,
        s3.Column_78,
        s3.Column_79,
        s3.Column_80,
        s3.Column_81,
        s3.Column_82,
        s3.Column_83,
        s3.Column_84,
        s3.Column_85,
        s3.Column_86,
        s3.Column_87,
        s3.Column_88,
        s3.Column_89,
        s3.Column_90,
        s3.Column_91,
        s3.Column_92,
        s3.Column_93,
        s3.Column_94,
        s3.Column_95,
        s3.Column_96,
        s3.Column_97,
        s3.Column_98,
        s3.Column_99,
        s3.Column_100,
        s3.Column_101,
        s3.Column_102,
        s3.Column_103,
        s3.Column_104,
        s3.Column_105,
        s3.Column_106,
        s3.Column_107,
        s3.Column_108,
        s3.Column_109,
        s3.Column_110,
        s3.Column_111,
        s3.Column_112,
        s3.Column_113,
        s3.Column_114,
        s3.Column_115,
        s3.Column_116,
        s3.Column_117,
        s3.Column_118,
        s3.Column_119,
        s3.Column_120,
        s3.Column_121,
        s3.Column_122,
        s3.Column_123,
        s3.Column_124,
        s3.Column_125,
        s3.Column_126,
        s3.Column_127,
        s3.Column_128,
        s3.Column_129,
        s3.Column_130,
        s3.Column_131,
        s3.Column_132,
        s3.Column_133,
        s3.Column_134,
        s3.Column_135,
        s3.Column_136,
        s3.Column_137,
        s3.Column_138,
        s3.Column_139,
        s3.Column_140,
        s3.Column_141,
        s3.Column_142,
        s3.Column_143,
        s3.Column_144,
        s3.Column_145,
        s3.Column_146,
        s3.Column_147,
        s3.Column_148,
        s3.Column_149,
        s3.Column_150,
        s3.Column_151,
        s3.Column_152,
        s3.Column_153,
        s3.Column_154,
        s3.Column_155,
        s3.Column_156,
        s3.Column_157,
        s3.Column_158,
        s3.Column_159,
        s3.Column_160,
        s3.Column_161,
        s3.Column_162,
        s3.Column_163,
        s3.Column_164,
        s3.Column_165,
        s3.Column_166,
        s3.Column_167,
        s3.Column_168,
        s3.Column_169,
        s3.Column_170,
        s3.Column_171,
        s3.Column_172,
        s3.Column_173,
        s3.Column_174,
        s3.Column_175,
        s3.Column_176,
        s3.Column_177,
        s3.Column_178,
        s3.Column_179,
        s3.Column_180,
        s3.Column_181,
        s3.Column_182,
        s3.Column_183,
        s3.Column_184,
        s3.Column_185,
        s3.Column_186,
        s3.Column_187,
        s3.Column_188,
        s3.Column_189,
        s3.Column_190,
        s3.Column_191,
        s3.Column_192,
        s3.Column_193,
        s3.Column_194,
        s3.Column_195,
        s3.Column_196,
        s3.Column_197,
        s3.Column_198,
        s3.Column_199,
        coalesce(source4.Column_200_update, s3.Column_200) as Column_200,
        updated_at
    from step3 as s3
    left join source4 on s3.PK = source4.PK

)

select
    *
from step4
